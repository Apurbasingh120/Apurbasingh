<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>City Hospital - Appointment Booking System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            background: white;
            padding: 20px 40px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
            margin-bottom: 30px;
        }

        header h1 {
            color: #667eea;
            font-size: 2.5rem;
            margin-bottom: 5px;
        }

        header p {
            color: #666;
            font-size: 1.1rem;
        }

        .nav-buttons {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 30px;
        }

        .nav-btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }

        .nav-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
        }

        .btn-book { background: linear-gradient(135deg, #11998e, #38ef7d); color: white; }
        .btn-view { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
        .btn-search { background: linear-gradient(135deg, #f093fb, #f5576c); color: white; }
        .btn-edit { background: linear-gradient(135deg, #4facfe, #00f2fe); color: white; }
        .btn-delete { background: linear-gradient(135deg, #ff416c, #ff4b2b); color: white; }

        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
        }

        .card h2 {
            color: #333;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: 600;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .submit-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s;
            width: 100%;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }

        th {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 5px;
            font-size: 0.9rem;
        }

        .edit-btn { background: #4facfe; color: white; }
        .delete-btn { background: #ff416c; color: white; }
        .receipt-btn { background: #11998e; color: white; }
        .download-btn { background: linear-gradient(135deg, #f093fb, #f5576c); color: white; margin-top: 15px; padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; font-size: 1rem; display: inline-flex; align-items: center; gap: 8px; }
        .download-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(240, 147, 251, 0.4); }

        .hidden { display: none; }

        .receipt {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            border: 2px dashed #667eea;
            padding: 30px;
            border-radius: 15px;
            margin-top: 20px;
        }

        .receipt h3 {
            text-align: center;
            color: #667eea;
            font-size: 1.8rem;
            margin-bottom: 5px;
        }

        .receipt h4 {
            text-align: center;
            color: #666;
            margin-bottom: 20px;
        }

        .receipt-details {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .receipt-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }

        .receipt-footer {
            text-align: center;
            margin-top: 20px;
            color: #666;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-box input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
        }

        .search-box button {
            padding: 12px 25px;
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 1.2rem;
        }

        .success-msg {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
        }

        .modal-buttons {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-buttons button {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }

        .confirm-btn { background: #ff416c; color: white; }
        .cancel-btn { background: #ddd; color: #333; }

        @media (max-width: 768px) {
            header h1 { font-size: 1.8rem; }
            .nav-buttons { flex-direction: column; }
            .nav-btn { width: 100%; justify-content: center; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üè• City Hospital</h1>
            <p>Appointment Management System</p>
        </header>

        <div class="nav-buttons">
            <button class="nav-btn btn-book" onclick="showSection('bookSection')">üìÖ Book Appointment</button>
            <button class="nav-btn btn-view" onclick="showSection('viewSection')">üìã View All</button>
            <button class="nav-btn btn-search" onclick="showSection('searchSection')">üîç Search</button>
        </div>

        <!-- Book Appointment Section -->
        <div id="bookSection" class="card">
            <h2>üìÖ Book New Appointment</h2>
            <div id="bookSuccess" class="success-msg hidden"></div>
            <form id="bookingForm" onsubmit="bookAppointment(event)">
                <div class="form-group">
                    <label>Patient Name</label>
                    <input type="text" id="patientName" required placeholder="Enter full name">
                </div>
                <div class="form-group">
                    <label>Age</label>
                    <input type="number" id="patientAge" required min="1" max="120" placeholder="Enter age">
                </div>
                <div class="form-group">
                    <label>Department</label>
                    <select id="department" required>
                        <option value="">Select Department</option>
                        <option value="Cardiology">‚ù§Ô∏è Cardiology</option>
                        <option value="Neurology">üß† Neurology</option>
                        <option value="Orthopedics">ü¶¥ Orthopedics</option>
                        <option value="General Medicine">üíä General Medicine</option>
                        <option value="Pediatrics">üë∂ Pediatrics</option>
                        <option value="Dermatology">ü©∫ Dermatology</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Date of Appointment</label>
                    <input type="date" id="appointmentDate" required>
                </div>
                <button type="submit" class="submit-btn">Book Appointment</button>
            </form>
            <div id="receiptSection" class="hidden"></div>
        </div>

        <!-- View All Section -->
        <div id="viewSection" class="card hidden">
            <h2>üìã All Appointments</h2>
            <div id="appointmentsList"></div>
        </div>

        <!-- Search Section -->
        <div id="searchSection" class="card hidden">
            <h2>üîç Search Patient</h2>
            <div class="search-box">
                <input type="text" id="searchInput" placeholder="Enter patient name...">
                <button onclick="searchPatient()">Search</button>
            </div>
            <div id="searchResults"></div>
        </div>

        <!-- Edit Modal -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <h2>‚úèÔ∏è Edit Appointment</h2>
                <form id="editForm" onsubmit="saveEdit(event)">
                    <input type="hidden" id="editIndex">
                    <div class="form-group">
                        <label>Patient Name</label>
                        <input type="text" id="editName" required>
                    </div>
                    <div class="form-group">
                        <label>Age</label>
                        <input type="number" id="editAge" required min="1" max="120">
                    </div>
                    <div class="form-group">
                        <label>Department</label>
                        <select id="editDepartment" required>
                            <option value="Cardiology">‚ù§Ô∏è Cardiology</option>
                            <option value="Neurology">üß† Neurology</option>
                            <option value="Orthopedics">ü¶¥ Orthopedics</option>
                            <option value="General Medicine">üíä General Medicine</option>
                            <option value="Pediatrics">üë∂ Pediatrics</option>
                            <option value="Dermatology">ü©∫ Dermatology</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Date of Appointment</label>
                        <input type="date" id="editDate" required>
                    </div>
                    <div class="modal-buttons">
                        <button type="button" class="cancel-btn" onclick="closeModal()">Cancel</button>
                        <button type="submit" class="confirm-btn" style="background: #4facfe;">Save Changes</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Delete Modal -->
        <div id="deleteModal" class="modal">
            <div class="modal-content">
                <h2>‚ö†Ô∏è Confirm Delete</h2>
                <p style="margin: 20px 0;">Are you sure you want to delete this appointment?</p>
                <div class="modal-buttons">
                    <button class="cancel-btn" onclick="closeDeleteModal()">Cancel</button>
                    <button class="confirm-btn" onclick="confirmDelete()">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        let appointments = JSON.parse(localStorage.getItem('appointments')) || [];
        let deleteIndex = null;

        function saveToStorage() {
            localStorage.setItem('appointments', JSON.stringify(appointments));
        }

        function showSection(sectionId) {
            document.querySelectorAll('.card').forEach(card => card.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
            
            if (sectionId === 'viewSection') {
                displayAppointments();
            }
        }

        function bookAppointment(event) {
            event.preventDefault();
            
            const appointment = {
                id: Date.now(),
                name: document.getElementById('patientName').value,
                age: document.getElementById('patientAge').value,
                department: document.getElementById('department').value,
                date: document.getElementById('appointmentDate').value
            };
            
            appointments.push(appointment);
            saveToStorage();
            
            // Show receipt
            showReceipt(appointment, appointments.length);
            
            // Reset form
            document.getElementById('bookingForm').reset();
            
            // Show success message
            const successMsg = document.getElementById('bookSuccess');
            successMsg.textContent = '‚úÖ Appointment booked successfully!';
            successMsg.classList.remove('hidden');
            setTimeout(() => successMsg.classList.add('hidden'), 3000);
        }

        function showReceipt(appointment, receiptNo) {
            const receiptHtml = `
                <div class="receipt">
                    <h3>üè• City Hospital</h3>
                    <h4>Appointment Receipt</h4>
                    <div class="receipt-details">
                        <div class="receipt-row">
                            <strong>Receipt No:</strong>
                            <span>#${receiptNo}</span>
                        </div>
                        <div class="receipt-row">
                            <strong>Patient Name:</strong>
                            <span>${appointment.name}</span>
                        </div>
                        <div class="receipt-row">
                            <strong>Age:</strong>
                            <span>${appointment.age} years</span>
                        </div>
                        <div class="receipt-row">
                            <strong>Department:</strong>
                            <span>${appointment.department}</span>
                        </div>
                        <div class="receipt-row">
                            <strong>Appointment Date:</strong>
                            <span>${formatDate(appointment.date)}</span>
                        </div>
                    </div>
                    <div class="receipt-footer">
                        <p>üìç 123 Health Street, Medical City</p>
                        <p>üìû +91-1234567890</p>
                        <p>üåê www.cityhospital.com</p>
                        <br>
                        <p><strong>Please arrive 15 minutes before your scheduled time.</strong></p>
                        <p>Thank you for choosing City Hospital!</p>
                    </div>
                    <div style="text-align: center;">
                        <button class="download-btn" onclick="downloadReceipt(${receiptNo}, '${appointment.name}', ${appointment.age}, '${appointment.department}', '${appointment.date}')">
                            üì• Download Receipt (JPEG)
                        </button>
                    </div>
                </div>
            `;
            
            document.getElementById('receiptSection').innerHTML = receiptHtml;
            document.getElementById('receiptSection').classList.remove('hidden');
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            return date.toLocaleDateString('en-IN', { 
                day: '2-digit', 
                month: '2-digit', 
                year: 'numeric' 
            });
        }

        function displayAppointments() {
            const container = document.getElementById('appointmentsList');
            
            if (appointments.length === 0) {
                container.innerHTML = '<div class="no-data">üì≠ No appointments found!</div>';
                return;
            }
            
            let html = `
                <table>
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Name</th>
                            <th>Age</th>
                            <th>Department</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            appointments.forEach((apt, index) => {
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${apt.name}</td>
                        <td>${apt.age}</td>
                        <td>${apt.department}</td>
                        <td>${formatDate(apt.date)}</td>
                        <td>
                            <button class="action-btn edit-btn" onclick="editAppointment(${index})">‚úèÔ∏è Edit</button>
                            <button class="action-btn delete-btn" onclick="deleteAppointment(${index})">üóëÔ∏è Delete</button>
                            <button class="action-btn receipt-btn" onclick="downloadReceipt(${index + 1}, '${apt.name}', ${apt.age}, '${apt.department}', '${apt.date}')">üì•</button>
                        </td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            html += `<p style="margin-top: 20px; color: #666;">üìä Total Appointments: ${appointments.length}</p>`;
            container.innerHTML = html;
        }

        function searchPatient() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const results = appointments.filter(apt => 
                apt.name.toLowerCase().includes(searchTerm)
            );
            
            const container = document.getElementById('searchResults');
            
            if (results.length === 0) {
                container.innerHTML = '<div class="no-data">‚ùå No patient found!</div>';
                return;
            }
            
            let html = '<div style="margin-top: 20px;">';
            results.forEach((apt, index) => {
                const originalIndex = appointments.findIndex(a => a.id === apt.id);
                html += `
                    <div class="receipt-details" style="margin-bottom: 15px;">
                        <div class="receipt-row"><strong>ID:</strong><span>${originalIndex + 1}</span></div>
                        <div class="receipt-row"><strong>Name:</strong><span>${apt.name}</span></div>
                        <div class="receipt-row"><strong>Age:</strong><span>${apt.age}</span></div>
                        <div class="receipt-row"><strong>Department:</strong><span>${apt.department}</span></div>
                        <div class="receipt-row"><strong>Date:</strong><span>${formatDate(apt.date)}</span></div>
                    </div>
                `;
            });
            html += '</div>';
            container.innerHTML = html;
        }

        function editAppointment(index) {
            const apt = appointments[index];
            document.getElementById('editIndex').value = index;
            document.getElementById('editName').value = apt.name;
            document.getElementById('editAge').value = apt.age;
            document.getElementById('editDepartment').value = apt.department;
            document.getElementById('editDate').value = apt.date;
            document.getElementById('editModal').style.display = 'flex';
        }

        function closeModal() {
            document.getElementById('editModal').style.display = 'none';
        }

        function saveEdit(event) {
            event.preventDefault();
            const index = document.getElementById('editIndex').value;
            
            appointments[index] = {
                ...appointments[index],
                name: document.getElementById('editName').value,
                age: document.getElementById('editAge').value,
                department: document.getElementById('editDepartment').value,
                date: document.getElementById('editDate').value
            };
            
            saveToStorage();
            closeModal();
            displayAppointments();
        }

        function deleteAppointment(index) {
            deleteIndex = index;
            document.getElementById('deleteModal').style.display = 'flex';
        }

        function closeDeleteModal() {
            document.getElementById('deleteModal').style.display = 'none';
            deleteIndex = null;
        }

        function confirmDelete() {
            if (deleteIndex !== null) {
                appointments.splice(deleteIndex, 1);
                saveToStorage();
                closeDeleteModal();
                displayAppointments();
            }
        }

        // Set minimum date to today
        document.getElementById('appointmentDate').min = new Date().toISOString().split('T')[0];

        function downloadReceipt(receiptNo, name, age, department, date) {
            // Create canvas
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas size
            canvas.width = 600;
            canvas.height = 750;
            
            // Background gradient
            const gradient = ctx.createLinearGradient(0, 0, 600, 750);
            gradient.addColorStop(0, '#667eea');
            gradient.addColorStop(1, '#764ba2');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, 600, 750);
            
            // White card background
            ctx.fillStyle = 'white';
            roundRect(ctx, 30, 30, 540, 690, 20, true, false);
            
            // Header background
            const headerGradient = ctx.createLinearGradient(30, 30, 570, 130);
            headerGradient.addColorStop(0, '#667eea');
            headerGradient.addColorStop(1, '#764ba2');
            ctx.fillStyle = headerGradient;
            roundRectTop(ctx, 30, 30, 540, 100, 20);
            
            // Hospital name
            ctx.fillStyle = 'white';
            ctx.font = 'bold 28px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('üè• CITY HOSPITAL', 300, 75);
            
            ctx.font = '16px Segoe UI';
            ctx.fillText('Appointment Receipt', 300, 105);
            
            // Receipt number box
            ctx.fillStyle = '#f0f4ff';
            roundRect(ctx, 50, 150, 500, 50, 10, true, false);
            ctx.fillStyle = '#667eea';
            ctx.font = 'bold 20px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText(`Receipt No: #${receiptNo}`, 300, 182);
            
            // Divider
            ctx.strokeStyle = '#667eea';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(50, 220);
            ctx.lineTo(550, 220);
            ctx.stroke();
            
            // Patient Details Header
            ctx.fillStyle = '#333';
            ctx.font = 'bold 18px Segoe UI';
            ctx.textAlign = 'left';
            ctx.fillText('PATIENT DETAILS', 50, 255);
            
            // Details
            const details = [
                { label: 'Patient Name', value: name },
                { label: 'Age', value: `${age} years` },
                { label: 'Department', value: department },
                { label: 'Appointment Date', value: formatDate(date) }
            ];
            
            let yPos = 295;
            details.forEach(detail => {
                // Label
                ctx.fillStyle = '#666';
                ctx.font = '14px Segoe UI';
                ctx.fillText(detail.label, 50, yPos);
                
                // Value
                ctx.fillStyle = '#333';
                ctx.font = 'bold 16px Segoe UI';
                ctx.fillText(detail.value, 50, yPos + 22);
                
                // Divider line
                ctx.strokeStyle = '#eee';
                ctx.lineWidth = 1;
                ctx.beginPath();
                ctx.moveTo(50, yPos + 35);
                ctx.lineTo(550, yPos + 35);
                ctx.stroke();
                
                yPos += 60;
            });
            
            // Contact Info Section
            ctx.fillStyle = '#f0f4ff';
            roundRect(ctx, 50, 520, 500, 120, 10, true, false);
            
            ctx.fillStyle = '#333';
            ctx.font = '14px Segoe UI';
            ctx.textAlign = 'center';
            ctx.fillText('üìç 123 Health Street, Medical City', 300, 550);
            ctx.fillText('üìû +91-1234567890', 300, 575);
            ctx.fillText('üåê www.cityhospital.com', 300, 600);
            ctx.font = 'bold 12px Segoe UI';
            ctx.fillText('Please arrive 15 minutes before your scheduled time', 300, 625);
            
            // Footer
            ctx.fillStyle = '#667eea';
            ctx.font = 'bold 16px Segoe UI';
            ctx.fillText('Thank you for choosing City Hospital!', 300, 680);
            
            // Date generated
            ctx.fillStyle = '#999';
            ctx.font = '10px Segoe UI';
            ctx.fillText(`Generated on: ${new Date().toLocaleString()}`, 300, 705);
            
            // Download
            const link = document.createElement('a');
            link.download = `CityHospital_Receipt_${receiptNo}_${name.replace(/\s+/g, '_')}.jpg`;
            link.href = canvas.toDataURL('image/jpeg', 0.95);
            link.click();
        }
        
        // Helper function to draw rounded rectangle
        function roundRect(ctx, x, y, width, height, radius, fill, stroke) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height - radius);
            ctx.quadraticCurveTo(x + width, y + height, x + width - radius, y + height);
            ctx.lineTo(x + radius, y + height);
            ctx.quadraticCurveTo(x, y + height, x, y + height - radius);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
            if (fill) ctx.fill();
            if (stroke) ctx.stroke();
        }
        
        // Helper function to draw rounded rectangle (top corners only)
        function roundRectTop(ctx, x, y, width, height, radius) {
            ctx.beginPath();
            ctx.moveTo(x + radius, y);
            ctx.lineTo(x + width - radius, y);
            ctx.quadraticCurveTo(x + width, y, x + width, y + radius);
            ctx.lineTo(x + width, y + height);
            ctx.lineTo(x, y + height);
            ctx.lineTo(x, y + radius);
            ctx.quadraticCurveTo(x, y, x + radius, y);
            ctx.closePath();
            ctx.fill();
        }
    </script>
</body>
</html>